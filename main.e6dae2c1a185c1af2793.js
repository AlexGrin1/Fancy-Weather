(()=>{"use strict";function e(e=(new Date).getHours()){return e>=21&&e<24||e>=0&&e<5?"night":"day"}const t={en:{feel:"FEELS LIKE",wind:"WIND",speed:"m/s",humidity:"HUMIDITY",search:"SEARCH",placeholder:"Search city",latitude:"Latitude",longitude:"Longitude",errorFindCity:"The city was not found. Try again",errorImages:"Error loading background image",errorOther:"Something went wrong"},ru:{feel:"ОЩУЩАЕТСЯ КАК",wind:"ВЕТЕР",speed:"м/с",humidity:"ВЛАЖНОСТЬ",search:"ПОИСК",placeholder:"Искать город",latitude:"Широта",longitude:"Долгота",errorFindCity:"Город не найден. Попробуйте заново",errorImages:"Ошибка загрузки фонового изображения",errorOther:"Что-то пошло не так"}};function n(t){const n={lightRain:[1063,1072,1153,1168,1183,1240,1261,1198],moderateRain:[1189,1186,1237],heavyRain:[1237,1264,1246,1195],lightSnow:[1066,1252,1069,1210],moderateSnow:[1201,1216,1204,1219,1255,1237],heavySnow:[1114,1222,1225,1258],partlyCloudy:[1003,1006],cloudy:[1009,1135,1147,1030],clear:[1e3]};for(const[o,a]of Object.entries(n))if(a.includes(t))return"partlyCloudy"===o||"clear"===o?`./assets/${o}${e()}.svg`:`./assets/${o}.svg`}const o=document.getElementById("choice_lang"),a=document.querySelector("#search"),r=document.querySelector("input"),c=document.getElementById("location");let i=localStorage.getItem("language")||"EN";o.addEventListener("change",(e=>{!function(e){i=e,a.innerHTML=t[i].search,r.setAttribute("placeholder",t[i].placeholder),localStorage.setItem("language",e)}(e.target.value),L(c.textContent)}));const l=document.getElementById("location"),d=document.getElementById("temp"),s=document.querySelector(".innerInfo"),u=document.querySelector("form"),m=document.querySelector("#choice_temp"),y=m.querySelectorAll("button"),g=document.querySelector(".coordinates"),h=document.getElementById("refreshImage"),v=document.querySelectorAll("option");let p,f,w,S,$;async function L(e){try{const a=await fetch(`https://api.weatherapi.com/v1/forecast.json?key=e656736c26754e098db140545212405&q=${e}&days=4&lang=${i}`),r=await a.json();r.error&&1006===r.error.code&&alert(t[i].errorFindCity);const c=[r.location.lon,r.location.lat];I=r.location.tz_id,function(e){(function(){const e=document.querySelector(".weatherOn3Days");l.innerHTML="",d.innerHTML="",s.innerHTML="",e.innerHTML="",g.innerHTML=""})(),p=localStorage.getItem("temperature")||document.querySelector(".active").dataset.value,y.forEach((e=>{e.classList.remove("active"),e.dataset.value===p&&e.classList.add("active")})),f=`temp_${p}`,w=`feelslike_${p}`,S=`maxtemp_${p}`,function(e){const o=e.location.name,a=e.location.country,r=n(e.current.condition.code),c=e.current.condition.text,u=Math.round(e.current[w]),m=Math.round(e.current.wind_kph*(5/18)),y=e.current.humidity;l.textContent=`${o}, ${a}`,d.innerHTML=`${Math.round(e.current[f])}&#176`,s.innerHTML=`<img src=${r} class="icon">\n  <div class='info_element'>${c}</div>\n  <div class='info_element'>${t[i].feel}: ${u} &#176</div>\n  <div class='info_element'>${t[i].wind}: ${m} ${t[i].speed}</div>\n  <div class='info_element'>${t[i].humidity}: ${y}%</div>\n  `}(e),function(e){const t=document.querySelector(".weatherOn3Days");t.innerHtml="",e.forecast.forecastday.forEach((e=>{const o=Math.round(e.day[S]),a=n(e.day.condition.code),r=new Date(e.date).toLocaleString(i,{weekday:"long"});t.innerHTML+=`\n    <div class="blockDayWeather">\n      <div class="weekDayNext>\n        <div class="week_day">${r}</div>\n      \n      <div class='weekDayWeather'>\n        <div class="next_day_weather">${o}&#176</div>\n        <img src='${a}'>\n      </div>\n      </div>\n    </div>`}))}(e),function(e){const n=e=>`${e.replace(".","&#176 ")} '`;g.innerHTML=`\n  <div>${t[i].latitude}: ${n(String(e.location.lat))}'</div>\n  <div>${t[i].longitude}: ${n(String(e.location.lon))}'</div>\n  `}(e)}(r),o=c,$.flyTo({center:o,essential:!0})}catch(e){alert(t[i].errorOther),E()}var o}let I="Europe/Minsk";async function E(){try{const e=await fetch("https://ipinfo.io?token=6520844a54f3ec"),t=await e.json();I=t.timezone,function(e){mapboxgl.accessToken="pk.eyJ1IjoiamVyb21pdHJ1IiwiYSI6ImNrcDV0MXRmMjF4bDQyb213NGpxZTNiNDkifQ.VgwARiMKZjGIkaYakkpQQw",$=new mapboxgl.Map({container:"map",center:e,zoom:9,interactive:!1,style:"mapbox://styles/mapbox/streets-v11"})}(t.loc.split(",").reverse()),L(t.city)}catch(e){alert(t[i].errorOther)}}document.addEventListener("DOMContentLoaded",(e=>{E(),v.forEach((e=>{e.removeAttribute("selected"),e.value.toUpperCase()===localStorage.getItem("language").toUpperCase()&&e.setAttribute("selected","")})),u.addEventListener("submit",(e=>{e.preventDefault(),function(){const e=document.querySelector("input");L(e.value),e.value=""}()})),m.addEventListener("click",(e=>{p!==e.target.dataset.value&&(localStorage.setItem("temperature",e.target.dataset.value),L(l.textContent))})),h.addEventListener("click",(e=>{!async function(){try{const e=await fetch("https://api.unsplash.com/photos/random?orientation=landscape&per_page=1&query=nature&client_id=7wYU5zOAy4uV-EdWgZkKEbVoLxPO4CCd_fhjcsRp5v8"),t=await e.json();document.body.style.background=`linear-gradient(rgba(8, 15, 26, 0.59) 0%, rgba(17, 17, 46, 0.46) 100%) 0% 0% , url(${t.urls.full}), no-repeat`}catch(e){alert(t[i].errorImages)}}()}))}));const M=document.getElementById("time"),k=document.getElementById("date");setInterval((()=>{!function(){const e=new Date,t=e.toLocaleString(i,{weekday:"short"}),n=e.toLocaleString(i,{month:"long"}),o=e.getDate();k.innerHTML=`${t} ${o} ${n}`}(),function(){const e=new Date((new Date).toLocaleString("en-US",{timeZone:I}));M.innerHTML=e.toLocaleTimeString()}()}),1e3)})();