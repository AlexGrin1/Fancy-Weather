(()=>{"use strict";const e=document.getElementById("choice_lang"),t=document.querySelector("#search"),n=document.querySelector("input"),a=document.getElementById("location");let o=localStorage.getItem("language")||"en";const r=document.getElementById("time"),i=document.getElementById("date"),c={en:{feel:"FEELS LIKE",wind:"WIND",speed:"m/s",humidity:"HUMIDITY",search:"SEARCH",placeholder:"Search city",latitude:"Latitude",longitude:"Longitude",errorFindCity:"The city was not found. Try again",errorImages:"Error loading background image",errorOther:"Something went wrong"},ru:{feel:"ОЩУЩАЕТСЯ КАК",wind:"ВЕТЕР",speed:"м/с",humidity:"ВЛАЖНОСТЬ",search:"ПОИСК",placeholder:"Искать город",latitude:"Широта",longitude:"Долгота",errorFindCity:"Город не найден. Попробуйте заново",errorImages:"Ошибка загрузки фонового изображения",errorOther:"Что-то пошло не так"}},l={lightRain:[1063,1072,1153,1168,1183,1240,1261,1198],moderateRain:[1189,1186,1237],heavyRain:[1237,1264,1246,1195],lightSnow:[1066,1252,1069,1210],moderateSnow:[1201,1216,1204,1219,1255,1237],heavySnow:[1114,1222,1225,1258],partlyCloudy:[1003,1006],cloudy:[1009,1135,1147,1030],clear:[1e3]};function d(e){const t=Object.keys(l).find((t=>l[t].includes(e)));return t?["partlyCloudy","clear"].includes(t)?`./assets/${t}${function(e=(new Date).getHours()){return e>=21||e<5?"night":"day"}()}.svg`:`./assets/${t}.svg`:"./assets/cloudy.svg"}const s=document.getElementById("location"),u=document.getElementById("temp"),m=document.querySelector(".innerInfo"),y=document.querySelector("input"),g=document.querySelector("#choice_temp"),h=g.querySelectorAll("button"),v=document.querySelector(".coordinates");let p,f,w="Europe/Minsk";async function $(e){try{const n=await fetch(`https://api.weatherapi.com/v1/forecast.json?key=e656736c26754e098db140545212405&q=${e}&days=4&lang=${o}`),a=await n.json();a.error&&1006===a.error.code&&alert(c[o].errorFindCity);const r=[a.location.lon,a.location.lat];w=a.location.tz_id,function(e){p=localStorage.getItem("temperature")||document.querySelector(".active").dataset.value,h.forEach((e=>{e.classList.remove("active"),e.dataset.value===p&&e.classList.add("active")})),function(){const e=document.querySelector(".weatherOn3Days");s.innerHTML="",u.innerHTML="",m.innerHTML="",e.innerHTML="",v.innerHTML=""}(),function(e){const t=e.location.name,{country:n}=e.location,a=d(e.current.condition.code),r=e.current.condition.text,i=Math.round(e.current[`feelslike_${p}`]),l=Math.round(e.current.wind_kph*(5/18)),y=e.current.humidity;s.textContent=`${t}, ${n}`,u.innerHTML=`${Math.round(e.current[`temp_${p}`])}&#176`,m.innerHTML=`<img src=${a} class='icon'>\n  <div class='info_element'>${r}</div>\n  <div class='info_element'>${c[o].feel}: ${i} &#176</div>\n  <div class='info_element'>${c[o].wind}: ${l} ${c[o].speed}</div>\n  <div class='info_element'>${c[o].humidity}: ${y}%</div>\n  `}(e),function(e){const t=document.querySelector(".weatherOn3Days");t.innerHtml="",e.forecast.forecastday.forEach((e=>{const n=Math.round(e.day[`maxtemp_${p}`]),a=d(e.day.condition.code),r=new Date(e.date).toLocaleString(o,{weekday:"long"});t.innerHTML+=`\n    <div class='blockDayWeather'>\n      <div class='weekDayNext>\n        <div class='week_day'>${r}</div>\n      <div class='weekDayWeather'>\n        <div class='next_day_weather'>${n}&#176</div>\n        <img src='${a}'>\n      </div>\n      </div>\n    </div>`}))}(e),function(e){const t=e=>`${e.replace(".","&#176 ")} '`;v.innerHTML=`\n  <div>${c[o].latitude}: ${t(String(e.location.lat))}'</div>\n  <div>${c[o].longitude}: ${t(String(e.location.lon))}'</div>\n  `}(e)}(a),t=r,f.flyTo({center:t,essential:!0})}catch(e){alert(c[o].errorOther)}var t}async function S(){try{const e=await fetch("https://api.unsplash.com/photos/random?orientation=landscape&per_page=1&query=nature&client_id=7wYU5zOAy4uV-EdWgZkKEbVoLxPO4CCd_fhjcsRp5v8"),t=await e.json();document.body.style.background=`linear-gradient(rgba(8, 15, 26, 0.59) 0%, rgba(17, 17, 46, 0.46) 100%) 0% 0% , url(${t.urls.full}), no-repeat`}catch(e){alert(c[o].errorImages)}}document.addEventListener("DOMContentLoaded",(()=>{const r=document.getElementById("refreshImage"),i=document.querySelector("form"),l=document.getElementById("choice_lang");S(),async function(){try{const t=await fetch("https://ipinfo.io?token=6520844a54f3ec"),n=await t.json();w=n.timezone,e=n.loc.split(",").reverse(),mapboxgl.accessToken="pk.eyJ1IjoiamVyb21pdHJ1IiwiYSI6ImNrcDV0MXRmMjF4bDQyb213NGpxZTNiNDkifQ.VgwARiMKZjGIkaYakkpQQw",f=new mapboxgl.Map({container:"map",center:e,zoom:9,interactive:!1,style:"mapbox://styles/mapbox/streets-v11"}),$(n.city)}catch(e){alert(e)}var e}(),l.value=o,i.addEventListener("submit",(e=>{e.preventDefault(),$(y.value),S(),y.value=""})),g.addEventListener("click",(e=>{p!==e.target.dataset.value&&(localStorage.setItem("temperature",e.target.dataset.value),$(s.textContent))})),r.addEventListener("click",(()=>{S()})),e.addEventListener("change",(e=>{var r;r=e.target.value,o=r,t.innerHTML=c[o].search,n.setAttribute("placeholder",c[o].placeholder),localStorage.setItem("language",r),$(a.textContent)}))})),setInterval((()=>{!function(){const e=new Date,t=new Date((new Date).toLocaleString("en-US",{timeZone:w})),n=e.toLocaleString(o,{weekday:"short"}),a=e.toLocaleString(o,{month:"long"}),c=e.getDate();i.innerHTML=`${n} ${c} ${a}`,r.innerHTML=t.toLocaleTimeString()}()}),1e3)})();